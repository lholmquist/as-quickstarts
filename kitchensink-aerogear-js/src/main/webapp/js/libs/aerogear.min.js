/*! AeroGear JavaScript Library - v1.0.0-M2 - 2013-01-21
* https://github.com/aerogear/aerogear-js
* JBoss, Home of Professional Open Source
* Copyright Red Hat, Inc., and individual contributors
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
* http://www.apache.org/licenses/LICENSE-2.0
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var AeroGear={};AeroGear.Core=function(){if(this instanceof AeroGear.Core)throw"Invalid instantiation of base class AeroGear.Core";this.add=function(e){var t,a,r=this[this.collectionName]||{};if(!e)return this;if("string"==typeof e)r[e]=AeroGear[this.lib].adapters[this.type](e);else if(AeroGear.isArray(e))for(t=0;e.length>t;t++)a=e[t],"string"==typeof a?r[a]=AeroGear[this.lib].adapters[this.type](a):r[a.name]=AeroGear[this.lib].adapters[a.type||this.type](a.name,a.settings||{});else r[e.name]=AeroGear[this.lib].adapters[e.type||this.type](e.name,e.settings||{});return this[this.collectionName]=r,this},this.remove=function(e){var t,a,r=this[this.collectionName]||{};if("string"==typeof e)delete r[e];else if(AeroGear.isArray(e))for(t=0;e.length>t;t++)a=e[t],"string"==typeof a?delete r[a]:delete r[a.name];else e&&delete r[e.name];return this[this.collectionName]=r,this}},AeroGear.isArray=function(e){return"[object Array]"==={}.toString.call(e)},function(e,t){e.ajax=function(a,r){var n=t.Deferred(function(){var n=this,s=t.extend({},{contentType:"application/json",dataType:"json"},r);this.done(s.success),this.fail(s.error),this.always(s.complete);var i=t.extend({},s,{success:function(e,t,a){n.resolve("string"==typeof e&&"json"===i.dataType?JSON.parse(e):e,t,a)},error:function(e,t,a){if("json"===i.dataType)try{e.responseJSON=JSON.parse(e.responseText)}catch(r){}n.reject(e,t,a)},complete:function(e,t){n.resolve(e,t)}});"application/json"!==i.contentType||!i.data||"POST"!==i.type&&"PUT"!==i.type||(i.data=JSON.stringify(i.data)),e.Auth&&!a.isAuthenticated()?this.reject("auth","Error: Authentication Required"):a.addAuthIdentifier?t.ajax(a.addAuthIdentifier(i)):t.ajax(i)}),s=n.promise();return s.success=n.done,s.error=n.fail,s.complete=n.always,s}}(AeroGear,jQuery),function(){function e(e,t,a){var r=t&&a||0,n=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>n&&(t[r+n++]=g[e])});16>n;)t[r+n++]=0;return t}function t(e,t){var a=t||0,r=f;return r[e[a++]]+r[e[a++]]+r[e[a++]]+r[e[a++]]+"-"+r[e[a++]]+r[e[a++]]+"-"+r[e[a++]]+r[e[a++]]+"-"+r[e[a++]]+r[e[a++]]+"-"+r[e[a++]]+r[e[a++]]+r[e[a++]]+r[e[a++]]+r[e[a++]]+r[e[a++]]}function a(e,a,r){var n=a&&r||0,s=a||[];e=e||{};var i=null!=e.clockseq?e.clockseq:v,o=null!=e.msecs?e.msecs:(new Date).getTime(),u=null!=e.nsecs?e.nsecs:S+1,c=o-D+(u-S)/1e4;if(0>c&&null==e.clockseq&&(i=16383&i+1),(0>c||o>D)&&null==e.nsecs&&(u=0),u>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");D=o,S=u,v=i,o+=122192928e5;var h=(1e4*(268435455&o)+u)%4294967296;s[n++]=255&h>>>24,s[n++]=255&h>>>16,s[n++]=255&h>>>8,s[n++]=255&h;var p=268435455&1e4*(o/4294967296);s[n++]=255&p>>>8,s[n++]=255&p,s[n++]=16|15&p>>>24,s[n++]=255&p>>>16,s[n++]=128|i>>>8,s[n++]=255&i;for(var d=e.node||A,l=0;6>l;l++)s[n+l]=d[l];return a?a:t(s)}function r(e,a,r){var n=a&&r||0;"string"==typeof e&&(a="binary"==e?new l(16):null,e=null),e=e||{};var s=e.random||(e.rng||d)();if(s[6]=64|15&s[6],s[8]=128|63&s[8],a)for(var i=0;16>i;i++)a[n+i]=s[i];return a||t(s)}var n,s,i,o=this,u=Array(16);if(n=function(){for(var e,e,t=u,a=0,a=0;16>a;a++)0==(3&a)&&(e=4294967296*Math.random()),t[a]=255&e>>>((3&a)<<3);return t},o.crypto&&crypto.getRandomValues){var c=new Uint32Array(4);i=function(){crypto.getRandomValues(c);for(var e=0;16>e;e++)u[e]=255&c[e>>2]>>>8*(3&e);return u}}try{var h=require("crypto").randomBytes;s=h&&function(){return h(16)}}catch(p){}for(var d=s||i||n,l="function"==typeof Buffer?Buffer:Array,f=[],g={},y=0;256>y;y++)f[y]=(y+256).toString(16).substr(1),g[f[y]]=y;var m=d(),A=[1|m[0],m[1],m[2],m[3],m[4],m[5]],v=16383&(m[6]<<8|m[7]),D=0,S=0,T=r;if(T.v1=a,T.v4=r,T.parse=e,T.unparse=t,T.BufferClass=l,T.mathRNG=n,T.nodeRNG=s,T.whatwgRNG=i,"undefined"!=typeof module)module.exports=T;else{var b=o.uuid;T.noConflict=function(){return o.uuid=b,T},o.uuid=T}}(),function(e){e.Pipeline=function(t){return this instanceof e.Pipeline?(e.Core.call(this),this.lib="Pipeline",this.type=t?t.type||"Rest":"Rest",this.collectionName="pipes",this.add(t),undefined):new e.Pipeline(t)},e.Pipeline.prototype=e.Core,e.Pipeline.constructor=e.Pipeline,e.Pipeline.adapters={}}(AeroGear,jQuery),function(e,t){e.Pipeline.adapters.Rest=function(t,a){if(!(this instanceof e.Pipeline.adapters.Rest))return new e.Pipeline.adapters.Rest(t,a);a=a||{};var r=a.endpoint||t,n={url:a.baseURL?a.baseURL+r:r},s=a.recordId||"id",i=a.authenticator||null;this.isAuthenticated=function(){return i?i.isAuthenticated():!0},this.addAuthIdentifier=function(e){return i?i.addAuthIdentifier(e):e},this.deauthorize=function(){i&&i.deauthorize()},this.getAjaxSettings=function(){return n},this.getRecordId=function(){return s}},e.Pipeline.adapters.Rest.prototype.read=function(a){var r,n,s,i,o=this.getRecordId(),u=this.getAjaxSettings();return a=a||{},r=a[o]?u.url+"/"+a[o]:u.url,n=function(){a.success&&a.success.apply(this,arguments)},s=function(){a.error&&a.error.apply(this,arguments)},i={type:"GET",data:a.query,success:n,error:s,url:r,statusCode:a.statusCode,complete:a.complete},a.jsonp&&(i.dataType="jsonp",i.jsonp=a.jsonp.callback?a.jsonp.callback:"callback",a.jsonp.customCallback&&(i.jsonpCallback=a.jsonp.customCallback)),e.ajax(this,t.extend({},this.getAjaxSettings(),i))},e.Pipeline.adapters.Rest.prototype.save=function(a,r){var n,s,i,o,u,c=this.getRecordId(),h=this.getAjaxSettings();return a=a||{},r=r||{},n=a[c]?"PUT":"POST",s=a[c]?h.url+"/"+a[c]:h.url,i=function(){r.success&&r.success.apply(this,arguments)},o=function(){r.error&&r.error.apply(this,arguments)},u={data:a,type:n,url:s,success:i,error:o,statusCode:r.statusCode,complete:r.complete},e.ajax(this,t.extend({},h,u))},e.Pipeline.adapters.Rest.prototype.remove=function(a,r){var n,s,i,o,u,c=this.getRecordId(),h=this.getAjaxSettings(),p="";return"string"==typeof a||"number"==typeof a?n=a:a&&a[c]?n=a[c]:a&&!r&&(r=a),r=r||{},p=n?"/"+n:"",s=h.url+p,i=function(){r.success&&r.success.apply(this,arguments)},o=function(){r.error&&r.error.apply(this,arguments)},u={type:"DELETE",url:s,success:i,error:o,statusCode:r.statusCode,complete:r.complete},e.ajax(this,t.extend({},h,u))}}(AeroGear,jQuery,uuid),function(e){e.DataManager=function(t){return this instanceof e.DataManager?(e.Core.call(this),this.lib="DataManager",this.type=t?t.type||"Memory":"Memory",this.collectionName="stores",this.add(t),undefined):new e.DataManager(t)},e.DataManager.prototype=e.Core,e.DataManager.constructor=e.DataManager,e.DataManager.adapters={},e.DataManager.STATUS_NEW=1,e.DataManager.STATUS_MODIFIED=2,e.DataManager.STATUS_REMOVED=0}(AeroGear,jQuery),function(e,t,a){e.DataManager.adapters.Memory=function(t,r){if(!(this instanceof e.DataManager.adapters.Memory))return new e.DataManager.adapters.Memory(t,r);r=r||{};var n=r.recordId?r.recordId:"id",s=null,i=!!r.dataSync;this.getRecordId=function(){return n},this.getData=function(t){var a,r,n=[];if(i&&!t){for(a in s)r=s[a]["ag-sync-status"],r!==e.DataManager.STATUS_REMOVED&&n.push(s[a]);return n}return s},this.setData=function(t){if(i)for(var a in t)t[a]["ag-sync-status"]=e.DataManager.STATUS_NEW;s=t},this.emptyData=function(){if(i)for(var t in s)s[t]["ag-sync-status"]=e.DataManager.STATUS_REMOVED;else s=null},this.addDataRecord=function(t){s=s||[],i&&(t["ag-sync-status"]=e.DataManager.STATUS_NEW,t.id=t.id||a()),s.push(t)},this.updateDataRecord=function(t,a){i&&(a["ag-sync-status"]=e.DataManager.STATUS_MODIFIED),s[t]=a},this.removeDataRecord=function(t){i?s[t]["ag-sync-status"]=e.DataManager.STATUS_REMOVED:s.splice(t,1)},this.getDataSync=function(){return i},this.traverseObjects=function(e,t,a){for(;"object"==typeof t&&a;)e=Object.keys(t)[0],t=t[e],a=a[e];return t===a?!0:!1}},e.DataManager.adapters.Memory.prototype.read=function(e){var t={};return t[this.getRecordId()]=e,e?this.filter(t):this.getData()},e.DataManager.adapters.Memory.prototype.save=function(t,a){var r=!1;if(t=e.isArray(t)?t:[t],a)this.setData(t);else if(this.getData())for(var n=0;t.length>n;n++){for(var s in this.getData())if(this.getData()[s][this.getRecordId()]===t[n][this.getRecordId()]){this.updateDataRecord(s,t[n]),r=!0;break}r||this.addDataRecord(t[n]),r=!1}else this.setData(t);return this.getData()},e.DataManager.adapters.Memory.prototype.remove=function(t){if(!t)return this.emptyData(),this.getData();t=e.isArray(t)?t:[t];for(var a,r,n,s=0;t.length>s;s++){if("string"==typeof t[s]||"number"==typeof t[s])a=t[s];else{if(!t)continue;a=t[s][this.getRecordId()]}r=this.getData(!0);for(n in r)r[n][this.getRecordId()]===a&&this.removeDataRecord(n)}return this.getData()},e.DataManager.adapters.Memory.prototype.filter=function(a,r){var n,s,i,o,u,c=this;return n=a?this.getData().filter(function(n){var h,p,d=r?!1:!0,l=Object.keys(a);for(s=0;l.length>s;s++){if(a[l[s]].data)for(h=a[l[s]],p=h.matchAny?!1:!0,i=0;h.data.length>i;i++)if(e.isArray(n[l[s]]))if(n[l[s]].length){if(0===t(n[l]).not(h.data).length&&0===t(h.data).not(n[l]).length){p=!0;break}for(o=0;n[l[s]].length>o;o++){if(h.matchAny&&h.data[i]===n[l[s]][o]){if(p=!0,r)break;for(u=0;n[l[s]].length>u;u++)if(!r&&h.data[i]!==n[l[s]][u]){p=!1;break}}if(!h.matchAny&&h.data[i]!==n[l[s]][o]){p=!1;break}}}else p=!1;else if("object"==typeof h.data[i]){if(h.matchAny&&c.traverseObjects(l[s],h.data[i],n[l[s]])){p=!0;break}if(!h.matchAny&&!c.traverseObjects(l[s],h.data[i],n[l[s]])){p=!1;break}}else{if(h.matchAny&&h.data[i]===n[l[s]]){p=!0;break}if(!h.matchAny&&h.data[i]!==n[l[s]]){p=!1;break}}else if(e.isArray(n[l[s]]))if(p=r?!1:!0,n[l[s]].length)for(i=0;n[l[s]].length>i;i++){if(r&&a[l[s]]===n[l[s]][i]){p=!0;break}if(!r&&a[l[s]]!==n[l[s]][i]){p=!1;break}}else p=!1;else p="object"==typeof a[l[s]]?c.traverseObjects(l[s],a[l[s]],n[l[s]]):a[l[s]]===n[l[s]]?!0:!1;if(r&&p){d=!0;break}if(!r&&!p){d=!1;break}}return d}):this.getData()||[]}}(AeroGear,jQuery,uuid),function(e){e.DataManager.adapters.SessionLocal=function(t,a){if(!(this instanceof e.DataManager.adapters.SessionLocal))return new e.DataManager.adapters.SessionLocal(t,a);e.DataManager.adapters.Memory.apply(this,arguments);var r=a.storageType||"sessionStorage",n=t,s=(a.dataSync,document.location.pathname.replace(/[\/\.]/g,"-")),i=n+s,o=JSON.parse(window[r].getItem(i));o&&e.DataManager.adapters.Memory.prototype.save.call(this,o,!0),this.getStoreType=function(){return r},this.getStoreKey=function(){return i}},e.DataManager.adapters.SessionLocal.prototype=Object.create(new e.DataManager.adapters.Memory,{save:{value:function(t,a){e.DataManager.adapters.Memory.prototype.save.apply(this,arguments);try{window[this.getStoreType()].setItem(this.getStoreKey(),JSON.stringify(this.getData())),a&&a.storageSuccess&&a.storageSuccess(t)}catch(r){if(!a||!a.storageError)throw r;a.storageError(r,t)}},enumerable:!0,configurable:!0,writable:!0},remove:{value:function(){e.DataManager.adapters.Memory.prototype.remove.apply(this,arguments),window[this.getStoreType()].setItem(this.getStoreKey(),JSON.stringify(this.getData()))},enumerable:!0,configurable:!0,writable:!0}})}(AeroGear,jQuery,uuid),function(e){e.Auth=function(t){return this instanceof e.Auth?(e.Core.call(this),this.lib="Auth",this.type=t?t.type||"Rest":"Rest",this.collectionName="modules",this.add(t),undefined):new e.Auth(t)},e.Auth.prototype=e.Core,e.Auth.constructor=e.Auth,e.Auth.adapters={}}(AeroGear,jQuery),function(e,t){e.Auth.adapters.Rest=function(a,r){if(!(this instanceof e.Auth.adapters.Rest))return new e.Auth.adapters.Rest(a,r);r=r||{};var n=r.endpoints||{},s=a,i=!!r.agAuth,o=r.baseURL,u=r.tokenName||"Auth-Token";this.isAuthenticated=function(){return i?!!sessionStorage.getItem("ag-auth-"+s):!0},this.addAuthIdentifier=function(e){return e.headers={},e.headers[u]=sessionStorage.getItem("ag-auth-"+s),t.extend({},e)},this.deauthorize=function(){sessionStorage.removeItem("ag-auth-"+s)},this.getSettings=function(){return r},this.getEndpoints=function(){return n},this.getName=function(){return s},this.getAGAuth=function(){return i},this.getBaseURL=function(){return o},this.getTokenName=function(){return u}},e.Auth.adapters.Rest.prototype.enroll=function(e,a){a=a||{};var r=this,n=this.getName(),s=this.getTokenName(),i=this.getBaseURL(),o=this.getEndpoints(),u=this.getAGAuth(),c=function(e,t,i){sessionStorage.setItem("ag-auth-"+n,r.getAGAuth()?i.getResponseHeader(s):"true"),a.success&&a.success.apply(this,arguments)},h=function(e,t,r){var n;try{e.responseJSON=JSON.parse(e.responseText),n=[e,t,r]}catch(s){n=arguments}a.error&&a.error.apply(this,n)},p={success:c,error:h,data:e},d="";return a.contentType?p.contentType=a.contentType:u&&(p.contentType="application/json"),a.dataType?p.dataType=a.dataType:u&&(p.dataType="json"),a.baseURL?d=a.baseURL:i&&(d=i),d+=o.enroll?o.enroll:"auth/enroll",d.length&&(p.url=d),t.ajax(t.extend({},this.getSettings(),{type:"POST"},p))},e.Auth.adapters.Rest.prototype.login=function(e,a){a=a||{};var r=this,n=this.getName(),s=this.getTokenName(),i=this.getBaseURL(),o=this.getEndpoints(),u=this.getAGAuth(),c=function(e,t,i){sessionStorage.setItem("ag-auth-"+n,r.getAGAuth()?i.getResponseHeader(s):"true"),a.success&&a.success.apply(this,arguments)},h=function(e,t,r){var n;try{e.responseJSON=JSON.parse(e.responseText),n=[e,t,r]}catch(s){n=arguments}a.error&&a.error.apply(this,n)},p={success:c,error:h,data:e},d="";return a.contentType?p.contentType=a.contentType:u&&(p.contentType="application/json"),a.dataType?p.dataType=a.dataType:u&&(p.dataType="json"),a.baseURL?d=a.baseURL:i&&(d=i),d+=o.login?o.login:"auth/login",d.length&&(p.url=d),t.ajax(t.extend({},this.getSettings(),{type:"POST"},p))},e.Auth.adapters.Rest.prototype.logout=function(e){e=e||{};var a=this,r=this.getName(),n=this.getTokenName(),s=this.getBaseURL(),i=this.getEndpoints(),o=function(){a.deauthorize(),e.success&&e.success.apply(this,arguments)},u=function(t,a,r){var n;try{t.responseJSON=JSON.parse(t.responseText),n=[t,a,r]}catch(s){n=arguments}e.error&&e.error.apply(this,n)},c={success:o,error:u},h="";return e.baseURL?h=e.baseURL:s&&(h=s),h+=i.logout?i.logout:"auth/logout",h.length&&(c.url=h),this.isAuthenticated()&&(c.headers={},c.headers[n]=sessionStorage.getItem("ag-auth-"+r)),t.ajax(t.extend({},this.getSettings(),{type:"POST"},c))}}(AeroGear,jQuery);
//@ sourceMappingURL=dist/aerogear.js.map